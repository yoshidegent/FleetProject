<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="fragments/layout :: head('RealDolmen Fleet - Car Model Overview')"/>

    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/r/bs/dt-1.10.9,af-2.0.0,fc-3.1.0,fh-3.0.0,kt-2.0.0,r-1.0.7,sc-1.3.0,se-1.0.1/datatables.min.css"/>
</head>
<body class="hold-transition skin-rd sidebar-mini">
<div class="wrapper">
    <th:block th:replace="fragments/admin :: header"></th:block>
    <th:block th:replace="fragments/layout :: sidebar(active='models')"></th:block>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                <th:block th:if="${editForm.id == null}">New Car Model</th:block>
                <th:block th:if="${editForm.id != null}" th:text="${editForm.brand + ' ' + editForm.model}"></th:block>
                <small>Edit</small>
            </h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
                <li class="active">Car Models</li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">
            <form action="#" th:action="@{/admin/car-model}" method="post"
                  enctype="multipart/form-data" th:object="${editForm}" role="form"
                  data-toggle="validator" class="form-horizontal">
                <div class="row margin-bottom">
                    <div class="col-sm-12">
                        <input type="submit" class="pull-right btn btn-flat btn-primary" value="Save" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-7">
                        <div class="box box-default">
                            <div class="box-header">
                                <i class="fa fa-picture-o"></i>
                                <h3 class="box-title">Picture</h3>
                            </div>
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <img class="img-responsive" id="carImage"
                                             th:if="${editForm.pictureUrl == null}"
                                             th:src="@{/images/car-shadow.png}"/>
                                        <img class="img-responsive" id="carImage"
                                             th:if="${editForm.pictureUrl != null}"
                                             th:src="${editForm.pictureUrl}"/>
                                    </div>
                                    <div class="col-sm-9">
                                        <label th:field="*{pictureUrl}">URL</label>
                                        <input id="pictureUrlInput" class="form-control" type="text"
                                               th:field="*{pictureUrl}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <div class="box box-default">
                            <div class="box-body">
                                <div>
                                    <div>
                                        <table>
                                            <thead>
                                            <tr>
                                                <th>Option</th>
                                                <th>Default</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="option : ${optionMap}"
                                                th:attr="data-option-id=${option.key.id}">
                                                <td th:text="${option.key.name}"></td>
                                                <td style="text-align: center">
                                                    <input type="checkbox"
                                                           th:checked="${option.value}"/>
                                                </td>
                                                <td style="text-align: center;">
                                                    <button class="deleteOptionBtn btn btn-danger btn-xs"
                                                            type="button"><span
                                                            class="glyphicon glyphicon-trash"></span>
                                                    </button>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div style='width:50px;text-align:center;vertical-align:middle;'>
                                        <input type='button' id='btnLeft' class="btn btn-primary"
                                               value=' ^ '/>
                                    </div>
                                    <div>
                                        <b>All options:</b><br/>
                                        <select multiple="multiple" id='lstBox1' style="width:100%;">
                                            <option value="ajax" th:each="option : ${globalOptions}"><span
                                                    th:text="${option.name}"></span></option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <i class="fa fa-text-width"></i>
                                <h3 class="box-title">Details</h3>
                            </div>
                            <div class="box-body">
                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="brand">Brand</label>

                                    <div class="col-sm-10">
                                        <input id="brand" type="text" class="form-control" th:field="*{brand}"
                                               required="required"/>

                                        <div class="help-block with-errors"></div>
                                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="model">Model</label>

                                    <div class="col-sm-10">
                                        <input id="model" type="text" class="form-control" th:field="*{model}"
                                               required="required"/>

                                        <div class="help-block with-errors"></div>
                                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="pack">Pack</label>

                                    <div class="col-sm-10">
                                        <input id="pack" type="text" class="form-control" th:field="*{pack}"
                                               required="required"/>

                                        <div class="help-block with-errors"></div>
                                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="fuelType">Fuel type</label>

                                    <div class="col-sm-10">
                                        <select id="fuelType" class="form-control" th:field="*{fuelType}">
                                            <option th:each="type : ${T(com.realdolmen.fleet.CarModel.FuelType).values()}"
                                                    th:value="${type}" th:text="${type.displayName}"></option>
                                        </select>
                                    </div>
                                    <div class="help-block with-errors"></div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="category">Category</label>

                                    <div class="col-sm-10">
                                        <input id="category" type="number" min="2" max="7" class="form-control"
                                               th:field="*{category}" required="required"/>

                                        <div class="help-block with-errors"></div>
                                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="emission">Emission</label>

                                    <div class="col-sm-10">
                                        <div class="input-group">
                                            <input id="emission" type="number" min="0" class="form-control"
                                                   th:field="*{co2Emission}" required="required"/>

                                            <div class="input-group-addon">g/km</div>
                                        </div>
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="fiscalHorsePower">Fiscal
                                        HP</label>

                                    <div class="col-sm-10">
                                        <input id="fiscalHorsePower" type="number" min="0" class="form-control"
                                               th:field="*{fiscalHorsePower}" required="required"/>

                                        <div class="help-block with-errors"></div>
                                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="listPrice">List price</label>

                                    <div class="col-sm-10">
                                        <div class="input-group">
                                            <div class="input-group-addon">â‚¬</div>
                                            <input id="listPrice" type="number" step="0.01" min="0.00"
                                                   class="form-control" th:field="*{listPriceInclVat}"
                                                   required="required"/>
                                        </div>
                                        <div class="help-block with-errors"></div>
                                        <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="idealKm">Ideal km</label>

                                    <div class="col-sm-10">
                                        <div class="input-group">
                                            <input id="idealKm" type="number" min="0" class="form-control"
                                                   th:field="*{idealKm}" required="required"/>

                                            <div class="input-group-addon">km</div>
                                        </div>
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="maxKm">Max. km</label>

                                    <div class="col-sm-10">
                                        <div class="input-group">
                                            <input id="maxKm" type="number" min="0" class="form-control"
                                                   th:field="*{maxKm}" required="required"/>

                                            <div class="input-group-addon">km</div>
                                        </div>
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>

                                <div class="form-group has-feedback">
                                    <label class="col-sm-2 control-label" for="deliveryTimeMonths">Delivery
                                        time</label>

                                    <div class="col-sm-10">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <input id="deliveryTimeMonths" type="number" min="0"
                                                       class="form-control"
                                                       th:field="*{deliveryTimeMonths}" required="required"/>
                                            </div>
                                            <div class="col-sm-6">
                                                <input id="deliveryTimeDays" type="number" min="0"
                                                       class="form-control"
                                                       th:field="*{deliveryTimeDays}" required="required"/>

                                                <div class="help-block with-errors"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <input type="hidden" th:field="*{id}"/>
                                <input type="hidden" th:field="*{version}"/>
                                <input type="hidden" id="optionIds" th:field="*{optionIds}"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <input type="submit" class="pull-right btn btn-flat btn-primary" value="Save" />
                    </div>
                </div>
            </form>
        </section>
    </div>

    <th:block th:replace="fragments/layout :: footer"></th:block>

</div>

<th:block th:replace="fragments/layout :: scripts"></th:block>

<script th:src="@{/scripts/validator.js}"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            $('form').validator();
        });
    })(jQuery);
</script>
<script th:inline="javascript">
    /*<![CDATA[*/
    $(document).ready(function () {

        var pictureUrl = $('#pictureUrlInput');
        var img = $('#carImage');
        var default_url = /*[[@{/images/car-shadow.png}]]*/'';

        var getPictureFromUrl = function () {
            var img_url = pictureUrl.val();
            img.attr('src', img_url);
        };

        pictureUrl.change(getPictureFromUrl);

        img.error(function () {
            $(this).attr('src', default_url);
        });

        var optionIdsInput = $('#OptionIds');

        var optionIds = optionIdsInput.split(',');
        console.log(optionIds);

    });
    /*]]>*/
</script>
</body>
</html>